---
title: 分布式文件系统
date: 2023-11-10 14:54:16
tags:
---

### 为什么用分布式文件系统

- 和业务系统独立
- 数据中心化实现服务无状态化
- 实现集群的前提
- 优点
  - 拓展能力: 毫无疑问，扩展能力是一个分布式文件系统最重要的特点
  - 高可用性: 在分布式文件系统中，高可用性包含两层，一是整个文件系统的可用性，二是数据的完整和一致性
  - 弹性存储: 可以根据业务需要灵活地增加或缩减数据存储以及增删存储池中的资源，而不需要中断系统运行
- 实现功能
  - 读写分离
  - 备份容错
  - 负载均衡
  - 动态扩容

<!-- more -->

### 自有搭建系统

- NFS（网络文件系统）FreeBSD支持的一种
- HDFS 大数据
- GFS（Google FS）

#### [FastDFS](https://github.com/happyfish100/fastdfs)
- 特点
  - 分组存储，简单灵活
  - 对等结构，不存在单点
  - 文件ID由FastDFS生成，作为文件访问凭证。FastDFS不需要传统的name server或meta server
  - 大、中、小文件均可以很好支持，可以存储海量小文件
  - 一台storage支持多块磁盘，支持单盘数据恢复
  - 提供了nginx扩展模块，可以和nginx无缝衔接
  - 支持多线程方式上传和下载文件，支持断点续传
  - 存储服务器上可以保存文件附加属性
- 架构
  - 跟踪服务器（tracker server）：客户端和存储服务器的中间层
    - 接收客户端请求，选择存储服务器
    - 检查存储服务器的状态
  - 存储服务器（storage server）：存储文件的服务器
    - 以组（卷，group或volume）为单位组织，一个group内包含多台storage机器，数据互为备份，存储空间以group内容量最小的storage为准，所以建议group内的多个storage尽量配置相同，以免造成存储空间的浪费。
    - 以group为单位组织存储能方便的进行应用隔离、负载均衡、副本数定制（group内storage server数量即为该group的副本数）
    - 在storage第一次启动时，会在每个数据存储目录里创建2级子目录，每级256个，总共65536个文件，新写的文件会以hash的方式被路由到其中某个子目录下，然后将文件数据直接作为一个本地文件存储到该目录中
  - 客户端（client）：上传下载的服务器
![](fastdfs1.png)
  
### 云存储

- 阿里云
- 七牛云
- 百度云
- AWS


